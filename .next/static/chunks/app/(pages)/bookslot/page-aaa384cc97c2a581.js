(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822],{2623:(e,t,o)=>{"use strict";o.d(t,{default:()=>i});var l=o(5155),n=o(2115),s=o(5695),a=o(3347);function i(e){let{children:t}=e,o=(0,s.useRouter)(),[i,r]=(0,n.useState)(!0),[d,c]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{localStorage.getItem("token")?c(!0):o.replace("/signin"),r(!1)},[o]),i)?(0,l.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,l.jsx)(a.a,{size:"lg",color:"#1e40af"})}):d?(0,l.jsx)(l.Fragment,{children:t}):null}},6641:(e,t,o)=>{Promise.resolve().then(o.bind(o,9889)),Promise.resolve().then(o.bind(o,2623))},9889:(e,t,o)=>{"use strict";o.d(t,{default:()=>g});var l=o(5155),n=o(2115),s=o(3527),a=o(1590),i=o(7287),r=o(3751),d=o(1220),c=o(3517),h=o(112),u=o(6707),p=o(6088),m=o(4540);function g(){let[e,t]=(0,n.useState)(""),[o,g]=(0,n.useState)(null),[x,f]=(0,n.useState)(""),[j,y]=(0,n.useState)(""),[b,k]=(0,n.useState)(""),[v,S]=(0,n.useState)(!1),[C,w]=(0,n.useState)([]),B=(0,m.d4)(e=>{var t;return null==(t=e.user.data)?void 0:t.id}),P=async()=>{let e=await fetch("http://gateway:8090/v1/users/doctors",{method:"GET",headers:{"Content-Type":"application/json"}}),t=await e.json();console.log("Doctors data:",t),w(t.map(e=>({value:e.id,label:e.email})))};(0,n.useEffect)(()=>{P()},[]);let E=async()=>{if(S(!0),!e||!o||!x){k("Please select all fields before booking."),S(!1);return}let t=await fetch("http://gateway:8090/v1/appointments/book",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patientId:B,doctorId:e,timeSlot:x,date:o})});if(console.log("Booking response:",t),t.ok){y("Appointment booked on ".concat(o," at ").concat(x)),S(!1);return}k((await t.json()).message||"Failed to book appointment."),S(!1)};return(0,l.jsxs)(l.Fragment,{children:[b&&(0,l.jsx)("div",{style:{position:"fixed",bottom:20,right:20,maxWidth:"350px",zIndex:2e3},children:(0,l.jsx)(s.E,{color:"red",title:"Booking Failed",withCloseButton:!0,onClose:()=>k(null),children:b})}),j&&(0,l.jsx)("div",{style:{position:"fixed",bottom:20,right:20,maxWidth:"350px",zIndex:2e3},children:(0,l.jsx)(s.E,{color:"green",title:"Booking Successful",withCloseButton:!0,onClose:()=>y(null),children:j})}),(0,l.jsx)(a.m,{size:"sm",style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,l.jsxs)(i.t,{shadow:"md",radius:"lg",p:"xl",withBorder:!0,style:{width:"100%"},children:[(0,l.jsx)(r.h,{order:2,align:"center",mb:"md",style:{color:"#1e3a8a"},children:"Book an Appointment"}),(0,l.jsxs)(d.B,{spacing:"md",children:[(0,l.jsx)(c.l,{label:"Select Doctor",placeholder:"Choose a doctor",data:C,value:e,onChange:t,required:!0}),(0,l.jsx)(p.l,{label:"Select Date",placeholder:"Pick a date",value:o,onChange:g,required:!0}),(0,l.jsx)(c.l,{label:"Select Time",placeholder:"Choose a timeSlot",data:["09:00 AM","10:30 AM","12:00 PM","02:00 PM","03:30 PM","05:00 PM"],value:x,onChange:f,required:!0}),(0,l.jsx)(h.Y,{position:"center",mt:"md",children:(0,l.jsx)(u.$,{color:"#1e3a8a",radius:"xl",size:"md",onClick:E,loading:v,children:"Book Appointment"})})]})]})})]})}}},e=>{e.O(0,[545,21,30,563,470,411,517,810,441,964,358],()=>e(e.s=6641)),_N_E=e.O()}]);